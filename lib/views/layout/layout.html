<!DOCTYPE html>
<html>
{% block html_head %}
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>{% block html_title %}{% endblock %} {{ config.crowi['app:title']|default('Crowi') }}</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="viewport" content="width=device-width,initial-scale=1">

  <meta name="apple-mobile-web-app-title" content="{{ config.crowi['app:title']|default('Crowi') }}">

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon"                 href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72"   href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">

  <link rel="stylesheet" href="/css/crowi.css">

  <script src="{{ assets('/js/runtime.js') }}"></script>
  <script src="{{ assets('/js/bundled.js') }}"></script>
  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
</head>
{% endblock %}

{% block html_body %}
<body
  class="crowi main-container {% block html_base_css %}{% endblock %}"
  data-me="{{ user._id.toString() }}"
 {% block html_base_attr %}{% endblock %}
 >

{% block layout_head_nav %}
<nav class="crowi-header navbar navbar-expand-md" role="navigation">
  <a class="navbar-brand" href="/">
    <img alt="Crowi" src="/logo/32x32.png" width="16">
    <span class="d-none d-sm-inline">{% block title %}{{ config.crowi['app:title']|default('Crowi') }}{% endblock %}</span>
  </a>

  {% if searchConfigured() %}
  <div class="search-top" role="search" id="search-top">
    <div class="search-box"> {# placeholder for react #}
      <form class="search-form input-group search-top-input-group">
        <input
            type="text"
            placeholder="Search ... Page Title (Path) and Content"
            class="search-top-input form-control" name="q" disabled="disabled">
        <div class="input-group-append">
          <button type="submit" class="btn btn-light">
            <i class="search-top-icon fa fa-search"></i>
          </button>
        </div>
      </form>
    </div>
  </div>
  {% endif %}

  <button class="btn navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fa fa-bars"></i>
  </button>

  <div id="navbarContent" class="collapse navbar-collapse ml-auto">
    <ul class="navbar-nav">
      {% if user and user.admin %}
      <li class="nav-item">
        <a href="/admin" id="link-mypage" class="nav-link">
          <i class="fa fa-cube"></i> {{ t('Admin') }}
        </a>
      </li>
      {% endif %}
      {% if user %}
      <li class="nav-item dropdown">
        <button class="btn btn-light create-page-button" data-target="#create-page" data-toggle="modal">
          <i class="fa fa-pencil-alt"></i> {{ t('New') }}
        </button>
      </li>
      <li id="login-user" class="nav-item">
        <a href="/user/{{ user.username }}" id="link-mypage" class="nav-link">
          <img src="{{ user|picture }}" class="picture picture-rounded" width="25" /> {{ user.name }}
        </a>
      </li>
      <li class="nav-item dropdown">
        <a href="#" id="nav-dropdown-menu" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button"><i class="fa fa-bars"></i> <label class="sr-only">メニュー</label></a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="nav-dropdown-menu">
          <a class="dropdown-item" href="/me"><i class="fa fa-cogs"></i> {{ t('User Settings') }}</a>
          <a class="dropdown-item" href="/trash/"><i class="fa fa-trash-alt"></i> {{ t('Deleted Pages') }}</a>
          <a class="dropdown-item" href="/logout"><i class="fa fa-sign-out-alt"></i> {{ t('Sign out') }}</a>
        </div>
      </li>
      {% else %}
      <li id="login-user" class="nav-item"><a href="/login" id="login" class="nav-link"><i class="fa fa-user"></i> Login</a></li>
      {% endif %}
      {% if config.crowi['app:confidential'] && config.crowi['app:confidential'] != '' %}
      <li class="nav-item confidential"><a href="#">{{ config.crowi['app:confidential'] }}</a></li>
      {% endif %}
    </ul>
  </div><!-- /.navbar-collapse -->
</nav>
{% include '../modal/create_page.html' %}
{% endblock  %} {# layout_head_nav #}

<div class="container-fluid">
  <div class="row">

    {% block layout_sidebar %}
    {% endblock %} {# layout_sidebar #}

    {% block layout_main %}
    {% endblock %} {# layout_main #}

    {% block footer %}
    {% endblock %}

  </div> {# /.row #}
</div> {# /.container-fluid #}

{% block body_end %}
{% endblock %}

{% include '../modal/help.html' %}
</body>
{% endblock %}

<script type="application/json" id="crowi-context-hydrate">
{{ local_config|json|safe }}
</script>
<script type="application/json" id="user-context-hydrate">
{{ user_context|json|safe }}
</script>

<script src="{{ assets('/js/app.js') }}"></script>
<script src="{{ assets('/js/crowi.js') }}"></script>
</html>
